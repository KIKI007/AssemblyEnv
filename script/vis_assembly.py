import os
import numpy as np
import polyscope as ps
from AssemblyEnv.geometry import AssemblyChecker, AssemblyGUI
import time
import itertools
from AssemblyEnv import DATA_DIR
def gui(viewer):
    ps.init()
    ps.set_navigation_style("turntable")
    ps.set_ground_plane_mode("shadow_only")
    ps.set_up_dir("z_up")
    ps.look_at((0., -5., 3.5), (0., 0., 0.))

    viewer.render()
    ps.set_user_callback(viewer.interface)

    ps.show()

if __name__ == "__main__":
    #parts =   [[[7.5760441129501697, 2.757454550601556], [8.0622577482985509, 0.0], [10.0, 0.0], [9.3969262078590852, 3.420201433256687], [7.5760441129501697, 2.757454550601556]], [[6.1760477470770274, 5.182319386705605], [7.5760441129501697, 2.757454550601556], [9.3969262078590852, 3.420201433256687], [7.6604444311897817, 6.4278760968653907], [6.1760477470770274, 5.182319386705605]], [[4.0311288741492755, 6.9821200218844721], [6.1760477470770274, 5.182319386705605], [7.6604444311897817, 6.4278760968653907], [5.0000000000000027, 8.6602540378443873], [4.0311288741492755, 6.9821200218844721]], [[1.3999963658739316, 7.9397739373070175], [4.0311288741492755, 6.9821200218844721], [5.0000000000000027, 8.6602540378443873], [1.7364817766693057, 9.8480775301220831], [1.3999963658739316, 7.9397739373070175]], [[-1.3999963658787249, 7.9397739373061738], [1.3999963658739316, 7.9397739373070175], [1.7364817766693057, 9.8480775301220831], [-1.7364817766693017, 9.8480775301220831], [-1.3999963658787249, 7.9397739373061738]], [[-4.0311288741492737, 6.9821200218844721], [-1.3999963658787249, 7.9397739373061738], [-1.7364817766693017, 9.8480775301220831], [-4.9999999999999991, 8.6602540378443891], [-4.0311288741492737, 6.9821200218844721]], [[-7.6604444311897808, 6.427876096865397], [-6.1760477470770265, 5.1823193867056068], [-4.0311288741492737, 6.9821200218844721], [-4.9999999999999991, 8.6602540378443891], [-7.6604444311897808, 6.427876096865397]], [[-9.3969262078590852, 3.4202014332566906], [-7.5760441129501599, 2.7574545506015555], [-6.1760477470770265, 5.1823193867056068], [-7.6604444311897808, 6.427876096865397], [-9.3969262078590852, 3.4202014332566906]], [[-10.000000000000004, 3.1086244689504383e-15], [-8.0622577482985527, 2.5062531711346134e-15], [-7.5760441129501599, 2.7574545506015555], [-9.3969262078590852, 3.4202014332566906], [-10.000000000000004, 3.1086244689504383e-15]]]
    #parts = [[[14.0, 1.7320508075688772], [13.0, 1.7320508075688772], [13.5, 0.8660254037844386], [13.0, 0.0], [14.0, 0.0], [15.0, 0.0], [14.5, 0.8660254037844386], [15.0, 1.7320508075688772]], [[13.0, 3.4641016151377544], [12.0, 3.4641016151377544], [12.5, 2.598076211353316], [12.0, 1.7320508075688772], [13.0, 1.7320508075688772], [14.0, 1.7320508075688772], [13.5, 2.598076211353316], [14.0, 3.4641016151377544]], [[14.0, 5.196152422706632], [13.0, 5.196152422706631], [13.5, 4.330127018922193], [13.0, 3.4641016151377544], [14.0, 3.4641016151377544], [15.0, 3.4641016151377544], [14.5, 4.330127018922193], [15.0, 5.196152422706632]], [[15.0, 6.928203230275509], [14.0, 6.928203230275509], [14.5, 6.06217782649107], [14.0, 5.196152422706632], [15.0, 5.196152422706632], [16.0, 5.196152422706632], [15.5, 6.06217782649107], [16.0, 6.928203230275509]], [[14.0, 6.928203230275509], [13.0, 6.928203230275509], [12.5, 6.06217782649107], [13.0, 5.196152422706632], [14.0, 5.196152422706632], [14.5, 6.06217782649107]], [[12.5, 7.794228634059947], [11.5, 7.794228634059947], [12.0, 6.928203230275509], [12.5, 6.06217782649107], [13.0, 6.928203230275509], [14.0, 6.928203230275509], [13.5, 7.794228634059947], [13.0, 8.660254037844386]], [[11.5, 7.794228634059947], [10.5, 7.794228634059947], [10.0, 6.928203230275509], [10.5, 6.06217782649107], [11.5, 6.06217782649107], [12.0, 6.928203230275509]], [[11.5, 6.06217782649107], [10.5, 6.06217782649107], [11.0, 5.196152422706631], [11.5, 4.330127018922193], [12.0, 5.196152422706632], [13.0, 5.196152422706632], [12.5, 6.06217782649107], [12.0, 6.928203230275509]], [[13.0, 5.196152422706632], [12.0, 5.196152422706631], [11.5, 4.330127018922193], [12.0, 3.4641016151377544], [13.0, 3.4641016151377544], [13.5, 4.330127018922193]], [[10.5, 4.330127018922193], [9.5, 4.330127018922193], [10.0, 3.4641016151377544], [10.5, 2.598076211353316], [11.0, 3.4641016151377544], [12.0, 3.4641016151377544], [11.5, 4.330127018922193], [11.0, 5.196152422706631]], [[12.0, 3.4641016151377544], [11.0, 3.4641016151377544], [10.5, 2.598076211353316], [11.0, 1.7320508075688772], [12.0, 1.7320508075688772], [12.5, 2.598076211353316]], [[10.5, 2.598076211353316], [9.5, 2.598076211353316], [9.0, 1.7320508075688772], [9.5, 0.8660254037844386], [10.5, 0.8660254037844386], [11.0, 1.7320508075688772]], [[10.5, 0.8660254037844386], [9.5, 0.8660254037844386], [10.0, 0.0], [10.5, -0.8660254037844386], [11.0, 0.0], [12.0, 0.0], [11.5, 0.8660254037844386], [11.0, 1.7320508075688772]], [[8.5, 0.8660254037844386], [7.5, 0.8660254037844386], [8.0, 0.0], [8.5, -0.8660254037844386], [9.0, 0.0], [10.0, 0.0], [9.5, 0.8660254037844386], [9.0, 1.7320508075688772]], [[6.5, 0.8660254037844386], [5.5, 0.8660254037844386], [6.0, 0.0], [6.5, -0.8660254037844386], [7.0, 0.0], [8.0, 0.0], [7.5, 0.8660254037844386], [7.0, 1.7320508075688772]], [[5.0, 1.7320508075688772], [4.0, 1.7320508075688772], [4.5, 0.8660254037844386], [4.0, 0.0], [5.0, 0.0], [6.0, 0.0], [5.5, 0.8660254037844386], [6.0, 1.7320508075688772]], [[6.0, 3.4641016151377544], [5.0, 3.4641016151377544], [5.5, 2.598076211353316], [5.0, 1.7320508075688772], [6.0, 1.7320508075688772], [7.0, 1.7320508075688772], [6.5, 2.598076211353316], [7.0, 3.4641016151377544]], [[5.0, 3.4641016151377544], [4.0, 3.4641016151377544], [3.5, 2.598076211353316], [4.0, 1.7320508075688772], [5.0, 1.7320508075688772], [5.5, 2.598076211353316]], [[5.0, 5.196152422706632], [4.0, 5.196152422706631], [3.5, 4.330127018922193], [4.0, 3.4641016151377544], [5.0, 3.4641016151377544], [5.5, 4.330127018922193]], [[6.0, 5.196152422706632], [5.0, 5.196152422706631], [5.5, 4.330127018922193], [5.0, 3.4641016151377544], [6.0, 3.4641016151377544], [7.0, 3.4641016151377544], [6.5, 4.330127018922193], [7.0, 5.196152422706632]], [[6.0, 6.928203230275509], [5.0, 6.928203230275509], [4.5, 6.06217782649107], [5.0, 5.196152422706632], [6.0, 5.196152422706632], [6.5, 6.06217782649107]], [[5.0, 6.928203230275509], [6.0, 6.928203230275509], [6.5, 6.06217782649107], [7.0, 6.928203230275509], [7.5, 7.794228634059947], [6.5, 7.794228634059947], [6.0, 8.660254037844386], [5.5, 7.794228634059947]], [[6.0, 5.196152422706632], [7.0, 5.196152422706631], [7.5, 4.330127018922193], [8.0, 5.196152422706632], [8.5, 6.06217782649107], [7.5, 6.06217782649107], [7.0, 6.928203230275509], [6.5, 6.06217782649107]], [[8.5, 7.794228634059947], [7.5, 7.794228634059947], [7.0, 6.928203230275509], [7.5, 6.06217782649107], [8.5, 6.06217782649107], [9.0, 6.928203230275509]], [[9.5, 7.794228634059947], [8.5, 7.794228634059947], [9.0, 6.928203230275509], [8.5, 6.06217782649107], [9.5, 6.06217782649107], [10.5, 6.06217782649107], [10.0, 6.928203230275509], [10.5, 7.794228634059947]]]
    #parts.extend([[[0.0, -0.8660254037844386], [5.0, -0.8660254037844386], [5.0, 0.0], [0.0, 0.0]], [[11.0, -0.8660254037844386], [15.0, -0.8660254037844386], [15.0, 0.0], [11.0, 0.0]]])
    # parts = [[[4.0, 3.0], [5.0, 3.0], [5.0, 5.0], [4.0, 5.0]],
    #          [[0.0, 3.0], [1.0, 3.0], [1.0, 5.0], [0.0, 5.0]],
    #          [[2.0, 3.0], [3.0, 3.0], [3.0, 5.0], [2.0, 5.0]],
    #          [[2.0, 0.0], [3.0, 0.0], [3.0, 2.0], [2.0, 2.0]],
    #          [[0.0, 0.0], [1.0, 0.0], [1.0, 2.0], [0.0, 2.0]],
    #          [[4.0, 0.0], [5.0, 0.0], [5.0, 2.0], [4.0, 2.0]],
    #          [[0.0, 2.0], [5.0, 2.0], [5.0, 3.0], [0.0, 3.0]],
    #          [[0.0, 5.0], [5.0, 5.0], [5.0, 6.0], [0.0, 6.0]]]
    viewer = AssemblyGUI()
    viewer.load_from_file(DATA_DIR + "/block/dome.obj")
    gui(viewer)